<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Memory Game - Brain Training</title>
  <style>
    /* ===== Reset & Base ===== */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --bg-primary: #1A1D23;
      --bg-secondary: #242830;
      --bg-card: #2D323A;
      --accent: #3B82F6;
      --accent-light: #60A5FA;
      --accent-glow: rgba(59, 130, 246, 0.25);
      --success: #F59E0B;
      --success-glow: rgba(245, 158, 11, 0.25);
      --warning: #F59E0B;
      --error: #EF4444;
      --text-primary: #F8FAFC;
      --text-secondary: #94A3B8;
      --text-muted: #64748B;
      --radius: 12px;
      --transition: 0.3s ease;
    }

    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow-x: hidden;
    }

    .header {
      text-align: center;
      padding: 2rem 1rem 1rem;
      width: 100%;
      max-width: 800px;
    }

    .header h1 {
      font-size: 2rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent), var(--success));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 0.25rem;
    }

    .header p {
      color: var(--text-secondary);
      font-size: 0.95rem;
    }

    .controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
      padding: 0.75rem 1rem;
      width: 100%;
      max-width: 800px;
    }

    .difficulty-btn, .control-btn {
      padding: 0.5rem 1.25rem;
      border: 2px solid var(--bg-card);
      border-radius: 2rem;
      background: transparent;
      color: var(--text-secondary);
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
    }

    .difficulty-btn:hover, .control-btn:hover {
      border-color: var(--accent);
      color: var(--text-primary);
    }

    .difficulty-btn.active {
      background: var(--accent);
      border-color: var(--accent);
      color: var(--text-primary);
      box-shadow: 0 0 20px var(--accent-glow);
    }

    .control-btn.pause-btn.paused {
      background: var(--warning);
      border-color: var(--warning);
      color: var(--bg-primary);
    }

    .control-btn.sound-btn.muted {
      opacity: 0.5;
    }

    .stats {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1.5rem;
      padding: 0.75rem 1rem;
      width: 100%;
      max-width: 800px;
      flex-wrap: wrap;
    }

    .stat {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.95rem;
      color: var(--text-secondary);
    }

    .stat-icon { font-size: 1.1rem; }

    .stat-value {
      font-weight: 700;
      color: var(--text-primary);
      min-width: 2ch;
    }

    .stars { display: flex; gap: 0.15rem; }

    .star {
      font-size: 1.1rem;
      transition: var(--transition);
    }

    .star.filled { color: var(--warning); }
    .star.empty { color: var(--text-muted); }

    .combo {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.95rem;
      color: var(--text-secondary);
      transition: var(--transition);
    }

    .combo.active {
      color: var(--success);
      transform: scale(1.1);
    }

    .combo-value {
      font-weight: 700;
      color: var(--success);
    }

    @keyframes combo-pop {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }

    .combo.pop { animation: combo-pop 0.3s ease; }

    .board-container {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 1rem;
      width: 100%;
      flex: 1;
      position: relative;
    }

    .board {
      display: grid;
      gap: 10px;
      perspective: 1000px;
      max-width: 700px;
      width: 100%;
    }

    .board.paused {
      opacity: 0.3;
      pointer-events: none;
    }

    .board.cols-4 { grid-template-columns: repeat(4, 1fr); }
    .board.cols-6 { grid-template-columns: repeat(6, 1fr); }

    .pause-overlay {
      display: none;
      position: absolute;
      inset: 0;
      background: rgba(26, 29, 35, 0.9);
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--warning);
      z-index: 10;
      border-radius: var(--radius);
    }

    .pause-overlay.show { display: flex; }

    .card {
      aspect-ratio: 1;
      position: relative;
      cursor: pointer;
      transform-style: preserve-3d;
      transition: transform 0.5s ease;
      border-radius: var(--radius);
    }

    .card.flipped { transform: rotateY(180deg); }

    .card.matched {
      transform: rotateY(180deg);
      cursor: default;
    }

    .card.matched .card-front {
      border-color: var(--success);
      box-shadow: 0 0 20px var(--success-glow), inset 0 0 20px var(--success-glow);
    }

    .card-face {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: var(--radius);
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
    }

    .card-back {
      background: var(--bg-card);
      border: 2px solid rgba(59, 130, 246, 0.2);
      transition: border-color var(--transition), box-shadow var(--transition);
    }

    .card-back::after {
      content: '?';
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--accent);
      opacity: 0.4;
    }

    .card:not(.flipped):not(.matched):hover .card-back {
      border-color: var(--accent);
      box-shadow: 0 0 15px var(--accent-glow);
    }

    .card-front {
      background: var(--bg-secondary);
      border: 2px solid var(--accent);
      transform: rotateY(180deg);
      font-size: 2.5rem;
      user-select: none;
    }

    @keyframes shake {
      0%, 100% { transform: rotateY(180deg) translateX(0); }
      25% { transform: rotateY(180deg) translateX(-6px); }
      75% { transform: rotateY(180deg) translateX(6px); }
    }

    .card.shake { animation: shake 0.4s ease; }

    @keyframes pop {
      0% { transform: rotateY(180deg) scale(1); }
      50% { transform: rotateY(180deg) scale(1.1); }
      100% { transform: rotateY(180deg) scale(1); }
    }

    .card.pop { animation: pop 0.4s ease; }

    .modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(26, 29, 35, 0.9);
      backdrop-filter: blur(4px);
      z-index: 100;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    .modal-overlay.show { display: flex; }

    .modal {
      background: var(--bg-secondary);
      border: 2px solid var(--accent);
      border-radius: 1.25rem;
      padding: 2.5rem 2rem;
      text-align: center;
      max-width: 400px;
      width: 100%;
      box-shadow: 0 0 60px var(--accent-glow);
      animation: modal-in 0.4s ease;
      position: relative;
      overflow: hidden;
    }

    @keyframes modal-in {
      from { opacity: 0; transform: scale(0.9) translateY(20px); }
      to { opacity: 1; transform: scale(1) translateY(0); }
    }

    .modal h2 {
      font-size: 1.75rem;
      margin-bottom: 0.25rem;
      background: linear-gradient(135deg, var(--success), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .modal .subtitle {
      color: var(--text-secondary);
      margin-bottom: 1.5rem;
      font-size: 0.95rem;
    }

    .modal-stats {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-bottom: 1.5rem;
    }

    .modal-stat {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.25rem;
    }

    .modal-stat .label {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--text-muted);
    }

    .modal-stat .value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text-primary);
    }

    .modal-stars {
      font-size: 1.8rem;
      margin-bottom: 1rem;
    }

    .best-score-msg {
      color: var(--warning);
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 1rem;
      display: none;
    }

    .best-score-msg.show { display: block; }

    .modal-btn {
      padding: 0.75rem 2rem;
      border: none;
      border-radius: 2rem;
      background: var(--accent);
      color: var(--text-primary);
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
    }

    .modal-btn:hover {
      background: var(--accent-light);
      box-shadow: 0 0 25px var(--accent-glow);
    }

    .confetti-container {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 200;
      overflow: hidden;
    }

    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      opacity: 0;
    }

    @keyframes confetti-fall {
      0% { opacity: 1; transform: translateY(-100%) rotate(0deg); }
      100% { opacity: 0; transform: translateY(100vh) rotate(720deg); }
    }

    .footer {
      text-align: center;
      padding: 1rem;
      color: var(--text-muted);
      font-size: 0.8rem;
    }

    .best-score {
      color: var(--text-secondary);
      font-size: 0.85rem;
      margin-bottom: 0.25rem;
    }

    .best-score span {
      color: var(--warning);
      font-weight: 700;
    }

    @media (max-width: 600px) {
      .header h1 { font-size: 1.5rem; }
      .board { gap: 7px; }
      .card-front { font-size: 1.8rem; }
      .card-back::after { font-size: 1.3rem; }
      .stats { gap: 0.75rem; }
      .stat { font-size: 0.85rem; }
      .modal-stats { gap: 1rem; }
      .controls { gap: 0.4rem; }
    }

    @media (max-width: 420px) {
      .board { gap: 5px; }
      .card-front { font-size: 1.4rem; }
      .controls { gap: 0.3rem; }
      .difficulty-btn, .control-btn { padding: 0.4rem 0.8rem; font-size: 0.75rem; }
    }
  </style>
</head>
<body>

  <div class="confetti-container" id="confetti"></div>

  <div class="header">
    <h1>Memory Game</h1>
    <p>Train your brain &mdash; find all the matching pairs</p>
  </div>

  <div class="controls">
    <button class="difficulty-btn active" data-level="easy">Easy</button>
    <button class="difficulty-btn" data-level="medium">Medium</button>
    <button class="difficulty-btn" data-level="hard">Hard</button>
    <button class="control-btn pause-btn" id="pauseBtn" title="Pause game">Pause</button>
    <button class="control-btn sound-btn" id="soundBtn" title="Toggle sound">Sound</button>
    <button class="control-btn" id="restartBtn" title="Restart game">Restart</button>
  </div>

  <div class="stats">
    <div class="stat">
      <span class="stat-icon">&#9201;</span>
      <span class="stat-value" id="timer">0:00</span>
    </div>
    <div class="stat">
      <span>Moves:</span>
      <span class="stat-value" id="moves">0</span>
    </div>
    <div class="combo" id="comboDisplay">
      <span>Combo:</span>
      <span class="combo-value" id="combo">0</span>
    </div>
    <div class="stat">
      <div class="stars" id="stars">
        <span class="star filled">&#9733;</span>
        <span class="star filled">&#9733;</span>
        <span class="star filled">&#9733;</span>
      </div>
    </div>
  </div>

  <div class="board-container">
    <div class="pause-overlay" id="pauseOverlay">PAUSED</div>
    <div class="board" id="board"></div>
  </div>

  <div class="footer">
    <div class="best-score" id="bestScore"></div>
    <div>Match pairs to exercise your memory</div>
  </div>

  <div class="modal-overlay" id="modal">
    <div class="modal">
      <h2>Well Done!</h2>
      <p class="subtitle">You found all the pairs</p>
      <div class="modal-stars" id="modalStars"></div>
      <div class="modal-stats">
        <div class="modal-stat">
          <span class="label">Time</span>
          <span class="value" id="modalTime">0:00</span>
        </div>
        <div class="modal-stat">
          <span class="label">Moves</span>
          <span class="value" id="modalMoves">0</span>
        </div>
        <div class="modal-stat">
          <span class="label">Best Combo</span>
          <span class="value" id="modalCombo">0</span>
        </div>
      </div>
      <div class="best-score-msg" id="bestMsg">New Best Score!</div>
      <button class="modal-btn" id="playAgainBtn">Play Again</button>
    </div>
  </div>

  <script>
    const AudioCtx = window.AudioContext || window.webkitAudioContext;
    let audioCtx = null;
    let soundEnabled = true;

    function initAudio() {
      if (!audioCtx) audioCtx = new AudioCtx();
    }

    function playTone(frequency, duration, type = 'sine', volume = 0.3) {
      if (!soundEnabled || !audioCtx) return;
      const oscillator = audioCtx.createOscillator();
      const gainNode = audioCtx.createGain();
      oscillator.connect(gainNode);
      gainNode.connect(audioCtx.destination);
      oscillator.frequency.value = frequency;
      oscillator.type = type;
      gainNode.gain.setValueAtTime(volume, audioCtx.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
      oscillator.start(audioCtx.currentTime);
      oscillator.stop(audioCtx.currentTime + duration);
    }

    function playFlipSound() { playTone(800, 0.1, 'sine', 0.2); }

    function playMatchSound() {
      playTone(523, 0.1, 'sine', 0.3);
      setTimeout(() => playTone(659, 0.1, 'sine', 0.3), 100);
      setTimeout(() => playTone(784, 0.15, 'sine', 0.3), 200);
    }

    function playMismatchSound() {
      playTone(200, 0.15, 'square', 0.2);
      setTimeout(() => playTone(180, 0.2, 'square', 0.2), 150);
    }

    function playWinSound() {
      const notes = [523, 659, 784, 1047];
      notes.forEach((note, i) => {
        setTimeout(() => playTone(note, 0.2, 'sine', 0.3), i * 150);
      });
    }

    function playComboSound(combo) {
      const freq = 400 + (combo * 100);
      playTone(Math.min(freq, 1200), 0.1, 'sine', 0.25);
    }

    function createConfetti() {
      const container = document.getElementById('confetti');
      const colors = ['#3B82F6', '#F59E0B', '#10B981', '#EF4444', '#8B5CF6', '#EC4899'];
      for (let i = 0; i < 100; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = Math.random() * 100 + '%';
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
        confetti.style.width = (Math.random() * 10 + 5) + 'px';
        confetti.style.height = (Math.random() * 10 + 5) + 'px';
        confetti.style.animation = `confetti-fall ${Math.random() * 2 + 2}s linear forwards`;
        confetti.style.animationDelay = Math.random() * 0.5 + 's';
        container.appendChild(confetti);
      }
      setTimeout(() => { container.innerHTML = ''; }, 4000);
    }

    const SYMBOLS = [
      'ðŸ¶','ðŸ±','ðŸ­','ðŸ¹','ðŸ°','ðŸ¦Š','ðŸ»','ðŸ¼',
      'ðŸ¨','ðŸ¯','ðŸ¦','ðŸ¸','ðŸµ','ðŸ”','ðŸ§','ðŸ¦',
      'ðŸ¦„','ðŸ','ðŸ™','ðŸ¦‹','ðŸŒ¸','ðŸŒ»','ðŸ„','ðŸ€'
    ];

    const LEVELS = {
      easy:   { cols: 4, rows: 3, pairs: 6  },
      medium: { cols: 4, rows: 4, pairs: 8  },
      hard:   { cols: 6, rows: 4, pairs: 12 }
    };

    let currentLevel = 'easy';
    let cards = [];
    let flippedCards = [];
    let matchedPairs = 0;
    let totalPairs = 0;
    let moves = 0;
    let timerInterval = null;
    let seconds = 0;
    let gameStarted = false;
    let lockBoard = false;
    let isPaused = false;
    let combo = 0;
    let bestCombo = 0;

    const boardEl = document.getElementById('board');
    const movesEl = document.getElementById('moves');
    const timerEl = document.getElementById('timer');
    const starsEl = document.getElementById('stars');
    const bestScoreEl = document.getElementById('bestScore');
    const modalEl = document.getElementById('modal');
    const modalTimeEl = document.getElementById('modalTime');
    const modalMovesEl = document.getElementById('modalMoves');
    const modalStarsEl = document.getElementById('modalStars');
    const modalComboEl = document.getElementById('modalCombo');
    const bestMsgEl = document.getElementById('bestMsg');
    const restartBtn = document.getElementById('restartBtn');
    const playAgainBtn = document.getElementById('playAgainBtn');
    const pauseBtn = document.getElementById('pauseBtn');
    const soundBtn = document.getElementById('soundBtn');
    const pauseOverlay = document.getElementById('pauseOverlay');
    const comboDisplay = document.getElementById('comboDisplay');
    const comboEl = document.getElementById('combo');
    const difficultyBtns = document.querySelectorAll('.difficulty-btn');

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function formatTime(s) {
      const m = Math.floor(s / 60);
      const sec = s % 60;
      return `${m}:${sec.toString().padStart(2, '0')}`;
    }

    function getStarCount() {
      const level = LEVELS[currentLevel];
      const optimal = level.pairs;
      const ratio = moves / optimal;
      if (ratio <= 1.5) return 3;
      if (ratio <= 2.5) return 2;
      return 1;
    }

    function renderStars(container, count) {
      container.innerHTML = '';
      for (let i = 0; i < 3; i++) {
        const span = document.createElement('span');
        span.className = 'star ' + (i < count ? 'filled' : 'empty');
        span.innerHTML = '&#9733;';
        container.appendChild(span);
      }
    }

    function updateComboDisplay() {
      comboEl.textContent = combo;
      if (combo > 1) {
        comboDisplay.classList.add('active', 'pop');
        setTimeout(() => comboDisplay.classList.remove('pop'), 300);
      } else {
        comboDisplay.classList.remove('active');
      }
    }

    function getBestScore() {
      try {
        const data = localStorage.getItem('memoryGame_best_' + currentLevel);
        return data ? JSON.parse(data) : null;
      } catch { return null; }
    }

    function saveBestScore(moves, time, stars) {
      try {
        const prev = getBestScore();
        if (!prev || stars > prev.stars || (stars === prev.stars && moves < prev.moves)) {
          localStorage.setItem('memoryGame_best_' + currentLevel, JSON.stringify({ moves, time, stars }));
          return true;
        }
      } catch {}
      return false;
    }

    function showBestScore() {
      const best = getBestScore();
      if (best) {
        bestScoreEl.innerHTML = `Best (${currentLevel}): <span>${best.moves} moves</span> &middot; ${formatTime(best.time)} &middot; ${'&#9733;'.repeat(best.stars)}`;
      } else {
        bestScoreEl.textContent = '';
      }
    }

    function startTimer() {
      if (timerInterval) return;
      timerInterval = setInterval(() => {
        if (!isPaused) {
          seconds++;
          timerEl.textContent = formatTime(seconds);
        }
      }, 1000);
    }

    function stopTimer() {
      clearInterval(timerInterval);
      timerInterval = null;
    }

    function resetTimer() {
      stopTimer();
      seconds = 0;
      timerEl.textContent = '0:00';
    }

    function togglePause() {
      if (!gameStarted) return;
      isPaused = !isPaused;
      pauseBtn.textContent = isPaused ? 'Resume' : 'Pause';
      pauseBtn.classList.toggle('paused', isPaused);
      boardEl.classList.toggle('paused', isPaused);
      pauseOverlay.classList.toggle('show', isPaused);
    }

    function createCard(symbol, index) {
      const card = document.createElement('div');
      card.className = 'card';
      card.dataset.symbol = symbol;
      card.dataset.index = index;
      card.innerHTML = `
        <div class="card-face card-back"></div>
        <div class="card-face card-front">${symbol}</div>
      `;
      card.addEventListener('click', () => handleCardClick(card));
      return card;
    }

    function handleCardClick(card) {
      if (lockBoard || isPaused) return;
      if (card.classList.contains('flipped') || card.classList.contains('matched')) return;
      initAudio();
      if (!gameStarted) {
        gameStarted = true;
        startTimer();
      }
      playFlipSound();
      card.classList.add('flipped');
      flippedCards.push(card);
      if (flippedCards.length === 2) {
        moves++;
        movesEl.textContent = moves;
        renderStars(starsEl, getStarCount());
        checkForMatch();
      }
    }

    function checkForMatch() {
      const [a, b] = flippedCards;
      const isMatch = a.dataset.symbol === b.dataset.symbol;
      if (isMatch) {
        handleMatch(a, b);
      } else {
        handleMismatch(a, b);
      }
    }

    function handleMatch(a, b) {
      combo++;
      if (combo > bestCombo) bestCombo = combo;
      updateComboDisplay();
      playMatchSound();
      if (combo > 1) {
        setTimeout(() => playComboSound(combo), 300);
      }
      a.classList.add('matched', 'pop');
      b.classList.add('matched', 'pop');
      flippedCards = [];
      matchedPairs++;
      if (matchedPairs === totalPairs) {
        stopTimer();
        setTimeout(() => {
          playWinSound();
          createConfetti();
          showWinModal();
        }, 600);
      }
    }

    function handleMismatch(a, b) {
      combo = 0;
      updateComboDisplay();
      lockBoard = true;
      setTimeout(() => {
        playMismatchSound();
        a.classList.add('shake');
        b.classList.add('shake');
      }, 400);
      setTimeout(() => {
        a.classList.remove('flipped', 'shake');
        b.classList.remove('flipped', 'shake');
        flippedCards = [];
        lockBoard = false;
      }, 1000);
    }

    function showWinModal() {
      const starCount = getStarCount();
      const isNewBest = saveBestScore(moves, seconds, starCount);
      modalTimeEl.textContent = formatTime(seconds);
      modalMovesEl.textContent = moves;
      modalComboEl.textContent = bestCombo;
      renderStars(modalStarsEl, starCount);
      bestMsgEl.classList.toggle('show', isNewBest);
      modalEl.classList.add('show');
      showBestScore();
    }

    function hideModal() {
      modalEl.classList.remove('show');
    }

    function initGame() {
      hideModal();
      resetTimer();
      gameStarted = false;
      lockBoard = false;
      isPaused = false;
      moves = 0;
      matchedPairs = 0;
      flippedCards = [];
      combo = 0;
      bestCombo = 0;
      movesEl.textContent = '0';
      comboEl.textContent = '0';
      comboDisplay.classList.remove('active');
      renderStars(starsEl, 3);
      pauseBtn.textContent = 'Pause';
      pauseBtn.classList.remove('paused');
      boardEl.classList.remove('paused');
      pauseOverlay.classList.remove('show');
      const level = LEVELS[currentLevel];
      totalPairs = level.pairs;
      const chosen = shuffle([...SYMBOLS]).slice(0, totalPairs);
      cards = shuffle([...chosen, ...chosen]);
      boardEl.className = 'board cols-' + level.cols;
      boardEl.innerHTML = '';
      cards.forEach((symbol, i) => {
        boardEl.appendChild(createCard(symbol, i));
      });
      showBestScore();
    }

    difficultyBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        difficultyBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentLevel = btn.dataset.level;
        initGame();
      });
    });

    restartBtn.addEventListener('click', initGame);
    playAgainBtn.addEventListener('click', initGame);
    pauseBtn.addEventListener('click', togglePause);

    soundBtn.addEventListener('click', () => {
      soundEnabled = !soundEnabled;
      soundBtn.classList.toggle('muted', !soundEnabled);
      soundBtn.textContent = soundEnabled ? 'Sound' : 'Muted';
    });

    modalEl.addEventListener('click', (e) => {
      if (e.target === modalEl) hideModal();
    });

    document.addEventListener('keydown', (e) => {
      if (e.code === 'Space') {
        e.preventDefault();
        togglePause();
      } else if (e.code === 'KeyR') {
        initGame();
      } else if (e.code === 'KeyM') {
        soundEnabled = !soundEnabled;
        soundBtn.classList.toggle('muted', !soundEnabled);
        soundBtn.textContent = soundEnabled ? 'Sound' : 'Muted';
      }
    });

    initGame();
  </script>

</body>
</html>
